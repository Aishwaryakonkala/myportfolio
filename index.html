<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Food Delivery App — PaymentFactory (Factory Method)</title>
  <style>
    :root{
      --bg:#0b1020; --card:#131a2b; --muted:#8ea3b5; --text:#e6eef7; --accent:#6ee7b7; --accent-2:#93c5fd;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:linear-gradient(180deg, #0b1020 0%, #101736 100%); color:var(--text)}
    .container{max-width:980px; margin:40px auto; padding:0 16px}
    h1{font-size:28px; line-height:1.2; margin:0 0 12px}
    p.lead{margin:0 0 20px; color:var(--muted)}
    .grid{display:grid; gap:16px; grid-template-columns:1fr;}
    @media (min-width: 960px){ .grid{grid-template-columns: 1.2fr .8fr} }
    .card{background:var(--card); border:1px solid rgba(255,255,255,.06); border-radius:16px; padding:18px; box-shadow:0 10px 30px rgba(0,0,0,.25)}
    .card h2{font-size:18px; margin:0 0 10px}
    label{display:block; font-weight:600; margin:12px 0 6px}
    input, select{width:100%; padding:10px 12px; background:#0e1424; color:var(--text); border:1px solid rgba(255,255,255,.12); border-radius:10px; outline:none}
    input::placeholder{color:#8a99ad}
    .row{display:grid; gap:12px; grid-template-columns:1fr}
    @media (min-width: 560px){ .row.two{grid-template-columns:1fr 1fr} }
    button{appearance:none; border:0; padding:12px 14px; font-weight:700; border-radius:12px; cursor:pointer; transition:transform .04s ease, box-shadow .2s ease;}
    .primary{background:linear-gradient(90deg, var(--accent), var(--accent-2)); color:#04121a; box-shadow:0 6px 20px rgba(93, 207, 180, .35)}
    .primary:active{transform:translateY(1px)}
    .muted{color:var(--muted)}
    .inline{display:flex; gap:10px; align-items:center}
    .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:12px; background:#0b1326; border:1px solid rgba(255,255,255,.1); border-radius:6px; padding:2px 6px; color:#cbd5e1}
    pre{margin:0; white-space:pre-wrap; word-break:break-word; background:#0b1326; border:1px solid rgba(255,255,255,.08); border-radius:12px; padding:12px; height:280px; overflow:auto}
    footer{margin-top:18px; color:var(--muted); font-size:13px}
    .badge{display:inline-flex; gap:6px; align-items:center; font-size:12px; font-weight:700; text-transform:uppercase; letter-spacing:.06em; background:#0a142a; border:1px solid rgba(255,255,255,.08); color:#a1b5ff; border-radius:999px; padding:6px 10px}
    .sep{opacity:.5; padding:0 8px}
  </style>
</head>
<body>
  <div class="container">
    <div class="inline" style="margin-bottom:12px">
      <span class="badge">Factory Method · PaymentFactory</span>
      <span class="sep">|</span>
      <span class="muted">Food Delivery App demo</span>
    </div>
    <h1>Food Delivery App — <span style="color:var(--accent)">PaymentFactory</span></h1>
    <p class="lead">Select a payment type (UPI, Wallet, COD, Credit Card), enter details, and see how a <strong>factory</strong> creates the proper payment object at runtime.</p>

    <div class="grid">
      <div class="card">
        <h2>Try it</h2>
        <form id="payment-form">
          <label for="payment-type">Payment Type</label>
          <select id="payment-type" required>
            <option value="upi">UPI</option>
            <option value="wallet">Wallet</option>
            <option value="cod">Cash on Delivery (COD)</option>
            <option value="card">Credit Card</option>
          </select>

          <div class="row two">
            <div>
              <label for="amount">Amount (₹)</label>
              <input id="amount" type="number" min="1" step="0.01" placeholder="e.g., 499" required />
            </div>
            <div>
              <label for="order-id">Order ID</label>
              <input id="order-id" type="text" placeholder="FD-2025-00123" />
            </div>
          </div>

          <div id="dynamic-fields" style="margin-top:6px"></div>

          <div style="margin-top:14px" class="inline">
            <button type="submit" class="primary">Pay Now</button>
            <button type="button" id="reset" class="kbd">Reset</button>
          </div>
        </form>
      </div>

      <div class="card">
        <h2>Console</h2>
        <pre id="console" aria-live="polite">Ready.
</pre>
      </div>
    </div>

    <footer>
      <strong>How it works:</strong> The form asks a <em>PaymentFactory</em> for an object that implements a common <em>Payment</em> interface. The concrete classes (<em>UPI</em>, <em>Wallet</em>, <em>COD</em>, <em>CreditCard</em>) handle their own processing.
    </footer>
  </div>

  <script>
    // ---- Payment Interface & Concrete Implementations ----
    class Payment {
      constructor(){ if (new.target === Payment) throw new Error('Payment is an interface-like base class. Use a concrete type.'); }
      /** @abstract */ process(amount, details){ throw new Error('Not implemented'); }
      get name(){ return this.constructor.name; }
    }

    class UPI extends Payment {
      process(amount, { vpa }){
        if(!vpa) throw new Error('UPI VPA is required');
        return UPI payment of ₹${amount.toFixed(2)} from ${vpa} authorized.;
      }
    }

    class Wallet extends Payment {
      process(amount, { provider, walletId }){
        if(!provider || !walletId) throw new Error('Wallet provider and ID are required');
        return ${provider} wallet (${walletId}) charged ₹${amount.toFixed(2)}.;
      }
    }

    class COD extends Payment {
      process(amount, { recipient }){
        if(!recipient) throw new Error('Recipient name is required for COD');
        return Cash of ₹${amount.toFixed(2)} will be collected on delivery from ${recipient}.;
      }
    }

    class CreditCard extends Payment {
      process(amount, { cardNumber, holder, expiry, cvv }){
        if(!cardNumber || !holder || !expiry || !cvv) throw new Error('Card number, holder, expiry, and CVV are required');
        const masked = String(cardNumber).replace(/\d(?=\d{4})/g, '•');
        return Card ${masked} ( ${holder} ) charged ₹${amount.toFixed(2)}.;
      }
    }

    // ---- Factory ----
    class PaymentFactory {
      /** @param {('upi'|'wallet'|'cod'|'card')} type */
      static create(type){
        switch(type){
          case 'upi': return new UPI();
          case 'wallet': return new Wallet();
          case 'cod': return new COD();
          case 'card': return new CreditCard();
          default: throw new Error(Unknown payment type: ${type});
        }
      }
    }

    // ---- UI Helpers ----
    const $ = (s, r=document) => r.querySelector(s);
    const log = (msg) => { const c = $('#console'); c.textContent += \n${msg}; c.scrollTop = c.scrollHeight; };

    function renderDynamicFields(type){
      const wrap = $('#dynamic-fields');
      if(type === 'upi'){
        wrap.innerHTML = `
          <label for="upi-vpa">UPI ID (VPA)</label>
          <input id="upi-vpa" type="text" placeholder="name@bank" />
        `;
      } else if(type === 'wallet'){
        wrap.innerHTML = `
          <div class="row two">
            <div>
              <label for="wallet-provider">Wallet Provider</label>
              <select id="wallet-provider">
                <option value="Paytm">Paytm</option>
                <option value="PhonePe">PhonePe</option>
                <option value="Amazon Pay">Amazon Pay</option>
                <option value="Mobikwik">Mobikwik</option>
              </select>
            </div>
            <div>
              <label for="wallet-id">Wallet ID / Phone</label>
              <input id="wallet-id" type="text" placeholder="98765 43210" />
            </div>
          </div>
        `;
      } else if(type === 'cod'){
        wrap.innerHTML = `
          <label for="cod-name">Recipient Name</label>
          <input id="cod-name" type="text" placeholder="e.g., Aishwarya K." />
        `;
      } else if(type === 'card'){
        wrap.innerHTML = `
          <div class="row two">
            <div>
              <label for="card-number">Card Number</label>
              <input id="card-number" inputmode="numeric" pattern="[0-9 ]*" placeholder="1234 5678 9012 3456" />
            </div>
            <div>
              <label for="card-holder">Card Holder</label>
              <input id="card-holder" type="text" placeholder="Name on card" />
            </div>
          </div>
          <div class="row two">
            <div>
              <label for="card-expiry">Expiry (MM/YY)</label>
              <input id="card-expiry" type="text" placeholder="08/28" />
            </div>
            <div>
              <label for="card-cvv">CVV</label>
              <input id="card-cvv" type="password" placeholder="*" />
            </div>
          </div>
        `;
      }
    }

    // ---- App ----
    document.addEventListener('DOMContentLoaded', () => {
      const typeSel = $('#payment-type');
      const form = $('#payment-form');

      renderDynamicFields(typeSel.value);
      typeSel.addEventListener('change', (e) => renderDynamicFields(e.target.value));

      $('#reset').addEventListener('click', () => {
        form.reset();
        renderDynamicFields(typeSel.value);
        $('#console').textContent = 'Ready.';
      });

      form.addEventListener('submit', (e) => {
        e.preventDefault();
        const type = typeSel.value;
        const amount = Number($('#amount').value);
        const orderId = $('#order-id').value || '(no order id)';

        try{
          const payment = PaymentFactory.create(type);
          let details = {};
          if(type === 'upi'){
            details.vpa = $('#upi-vpa').value.trim();
          } else if(type === 'wallet'){
            details.provider = $('#wallet-provider').value;
            details.walletId = $('#wallet-id').value.trim();
          } else if(type === 'cod'){
            details.recipient = $('#cod-name').value.trim();
          } else if(type === 'card'){
            details.cardNumber = $('#card-number').value.replace(/\s+/g, '');
            details.holder = $('#card-holder').value.trim();
            details.expiry = $('#card-expiry').value.trim();
            details.cvv = $('#card-cvv').value.trim();
          }

          if(!amount || amount <= 0){ throw new Error('Please enter a valid amount'); }
          const msg = payment.process(amount, details);
          log([${new Date().toLocaleTimeString()}] (${orderId}) ${msg});
        }catch(err){
          log(❗ ${err.message});
        }
      });
    });
  </script>
</body>
</html>